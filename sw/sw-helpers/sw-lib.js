/*
 Copyright 2016 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
(function(e,r){'object'==typeof exports&&'undefined'!=typeof module?module.exports=r():'function'==typeof define&&define.amd?define(r):(e.goog=e.goog||{},e.goog.swlib=r())})(this,function(){'use strict';function e(be,_e){for(var ke,Ee=[],Ce=0,Ne=0,qe='',xe=_e&&_e.delimiter||'/';null!=(ke=D.exec(be));){var Te=ke[0],Ie=ke[1],we=ke.index;if(qe+=be.slice(Ne,we),Ne=we+Te.length,Ie){qe+=Ie[1];continue}var De=be[Ne],Se=ke[2],We=ke[3],Ae=ke[4],Me=ke[5],Pe=ke[6],je=ke[7];qe&&(Ee.push(qe),qe='');var Oe=ke[2]||xe,Re=Ae||Me;Ee.push({name:We||Ce++,prefix:Se||'',delimiter:Oe,optional:'?'===Pe||'*'===Pe,repeat:'+'===Pe||'*'===Pe,partial:null!=Se&&null!=De&&De!==Se,asterisk:!!je,pattern:Re?s(Re):je?'.*':'[^'+n(Oe)+']+?'})}return Ne<be.length&&(qe+=be.substr(Ne)),qe&&Ee.push(qe),Ee}function r(be){return encodeURI(be).replace(/[\/?#]/g,function(_e){return'%'+_e.charCodeAt(0).toString(16).toUpperCase()})}function t(be){return encodeURI(be).replace(/[?#]/g,function(_e){return'%'+_e.charCodeAt(0).toString(16).toUpperCase()})}function a(be){for(var _e=Array(be.length),Ee=0;Ee<be.length;Ee++)'object'==typeof be[Ee]&&(_e[Ee]=new RegExp('^(?:'+be[Ee].pattern+')$'));return function(Ce,Ne){for(var Ie,qe='',xe=Ce||{},ke=(Ne||{}).pretty?r:encodeURIComponent,Te=0;Te<be.length;Te++){if(Ie=be[Te],'string'==typeof Ie){qe+=Ie;continue}var De,we=xe[Ie.name];if(null==we)if(Ie.optional){Ie.partial&&(qe+=Ie.prefix);continue}else throw new TypeError('Expected "'+Ie.name+'" to be defined');if(I(we)){if(!Ie.repeat)throw new TypeError('Expected "'+Ie.name+'" to not repeat, but received `'+JSON.stringify(we)+'`');if(0===we.length)if(Ie.optional)continue;else throw new TypeError('Expected "'+Ie.name+'" to not be empty');for(var Se=0;Se<we.length;Se++){if(De=ke(we[Se]),!_e[Te].test(De))throw new TypeError('Expected all "'+Ie.name+'" to match "'+Ie.pattern+'", but received `'+JSON.stringify(De)+'`');qe+=(0===Se?Ie.prefix:Ie.delimiter)+De}continue}if(De=Ie.asterisk?t(we):ke(we),!_e[Te].test(De))throw new TypeError('Expected "'+Ie.name+'" to match "'+Ie.pattern+'", but received "'+De+'"');qe+=Ie.prefix+De}return qe}}function n(be){return be.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function s(be){return be.replace(/([=!:$\/()])/g,'\\$1')}function o(be,_e){return be.keys=_e,be}function d(be){return be.sensitive?'':'i'}function h(be,_e){var Ee=be.source.match(/\((?!\?)/g);if(Ee)for(var Ce=0;Ce<Ee.length;Ce++)_e.push({name:Ce,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return o(be,_e)}function l(be,_e,Ee){for(var Ce=[],Ne=0;Ne<be.length;Ne++)Ce.push(f(be[Ne],_e,Ee).source);var qe=new RegExp('(?:'+Ce.join('|')+')',d(Ee));return o(qe,_e)}function u(be,_e,Ee){return g(e(be,Ee),_e,Ee)}function g(be,_e,Ee){I(_e)||(Ee=_e||Ee,_e=[]),Ee=Ee||{};for(var ke,Ce=Ee.strict,Ne=!1!==Ee.end,qe='',xe=0;xe<be.length;xe++)if(ke=be[xe],'string'==typeof ke)qe+=n(ke);else{var Te=n(ke.prefix),Ie='(?:'+ke.pattern+')';_e.push(ke),ke.repeat&&(Ie+='(?:'+Te+Ie+')*'),Ie=ke.optional?ke.partial?Te+'('+Ie+')?':'(?:'+Te+'('+Ie+'))?':Te+'('+Ie+')',qe+=Ie}var we=n(Ee.delimiter||'/'),De=qe.slice(-we.length)===we;return Ce||(qe=(De?qe.slice(0,-we.length):qe)+'(?:'+we+'(?=$))?'),qe+=Ne?'$':Ce&&De?'':'(?='+we+'|$)',o(new RegExp('^'+qe,d(Ee)),_e)}function f(be,_e,Ee){return I(_e)||(Ee=_e||Ee,_e=[]),Ee=Ee||{},be instanceof RegExp?h(be,_e):I(be)?l(be,_e,Ee):u(be,_e,Ee)}function y({channel:be,cacheName:_e,url:Ee,source:Ce}){q.isInstance({channel:be},BroadcastChannel),q.isType({cacheName:_e},'string'),q.isType({source:Ce},'string'),q.isType({url:Ee},'string'),be.postMessage({type:'CACHE_UPDATED',meta:Ce,payload:{cacheName:_e,updatedUrl:Ee}})}function v({first:be,second:_e,headersToCheck:Ee}={}){if(!(be instanceof Response&&_e instanceof Response&&Ee instanceof Array))throw me.createError('responses-are-same-parameters-required');return Ee.every(Ce=>{return be.headers.has(Ce)===_e.headers.has(Ce)&&be.headers.get(Ce)===_e.headers.get(Ce)})}class b{constructor(be){this._errors=be}createError(be,_e){if(!(be in this._errors))throw new Error(`Unable to generate error '${be}'.`);let Ee=this._errors[be].replace(/\s+/g,' '),Ce=null;_e&&(Ee+=` [${_e.message}]`,Ce=_e.stack);const Ne=new Error;return Ne.name=be,Ne.message=Ee,Ne.stack=Ce,Ne}}const _={'not-in-sw':'sw-lib must be loaded in your service worker file.','unsupported-route-type':'Routes must be either a express style route string, a Regex to capture request URLs or a Route instance.','empty-express-string':'The Express style route string must have some characters, an empty string is invalid.','bad-revisioned-cache-list':`The 'cacheRevisionedAssets()' method expects`+`an array of revisioned urls like so: ['/example/hello.1234.txt', `+`{path: 'hello.txt', revision: '1234'}]`};var E=new b(_);const C={'express-route-requires-absolute-path':`When using ExpressRoute, you must
    provide a path that starts with a '/' character. You can only match
    same-origin requests. For more flexibility, use RegExpRoute.`};var N=new b(C),q={atLeastOne:function(_e){const Ee=Object.keys(_e);if(!Ee.some(Ce=>_e[Ce]!==void 0))throw Error('Please set at least one of the following parameters: '+Ee.map(Ce=>`'${Ce}'`).join(', '))},hasMethod:function(_e,Ee){const Ce=Object.keys(_e).pop(),Ne=typeof _e[Ce][Ee];if('function'!=Ne)throw Error(`The '${Ce}' parameter must be an object that exposes `+`a '${Ee}' method.`)},isInstance:function(_e,Ee){const Ce=Object.keys(_e).pop();if(!(_e[Ce]instanceof Ee))throw Error(`The '${Ce}' parameter must be an instance of `+`'${Ee.name}'`)},isOneOf:function(_e,Ee){const Ce=Object.keys(_e).pop();if(!Ee.includes(_e[Ce]))throw Error(`The '${Ce}' parameter must be set to one of the `+`following: ${Ee}`)},isType:function(_e,Ee){const Ce=Object.keys(_e).pop(),Ne=typeof _e[Ce];if(Ne!==Ee)throw Error(`The '${Ce}' parameter has the wrong type. `+`(Expected: ${Ee}, actual: ${Ne})`)},isSWEnv:function(){return'ServiceWorkerGlobalScope'in self&&self instanceof ServiceWorkerGlobalScope},isValue:function(_e,Ee){const Ce=Object.keys(_e).pop(),Ne=_e[Ce];if(Ne!==Ee)throw Error(`The '${Ce}' parameter has the wrong value. `+`(Expected: ${Ee}, actual: ${Ne})`)}};const x=['DELETE','GET','HEAD','POST','PUT'];class k{constructor({match:be,handler:_e,method:Ee}={}){q.isType({match:be},'function'),q.hasMethod({handler:_e},'handle'),this.match=be,this.handler=_e,Ee?(q.isOneOf({method:Ee},x),this.method=Ee):this.method='GET'}}var T=Array.isArray||function(be){return'[object Array]'==Object.prototype.toString.call(be)},I=T,w=f,D=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');w.parse=e,w.compile=function(_e,Ee){return a(e(_e,Ee))},w.tokensToFunction=a,w.tokensToRegExp=g;class S extends k{constructor({path:be,handler:_e,method:Ee}){if('/'!==be.substring(0,1))throw N.createError('express-route-requires-absolute-path');let Ce=[];const Ne=w(be,Ce);super({match:({url:qe})=>{if(qe.origin!==location.origin)return null;const xe=qe.pathname.match(Ne);if(!xe)return null;const ke={};return Ce.forEach((Te,Ie)=>{ke[Te.name]=xe[Ie+1]}),ke},handler:_e,method:Ee})}}class W extends k{constructor({regExp:be,handler:_e,method:Ee}){q.isInstance({regExp:be},RegExp),super({match:({url:Ce})=>{const Ne=Ce.href.match(be);return Ne?Ne.slice(1):null},handler:_e,method:Ee})}}class A{setDefaultHandler({handler:be}={}){q.hasMethod({handler:be},'handle'),this.defaultHandler=be}setCatchHandler({handler:be}={}){q.hasMethod({handler:be},'handle'),this.catchHandler=be}registerRoutes({routes:be}={}){q.isInstance({routes:be},Array),self.addEventListener('fetch',_e=>{const Ee=new URL(_e.request.url);if(Ee.protocol.startsWith('http')){let Ce;for(let Ne of be||[])if(Ne.method===_e.request.method){const qe=Ne.match({url:Ee,event:_e});if(qe){let xe=qe;Array.isArray(xe)&&0===xe.length?xe=void 0:xe.constructor===Object&&0===Object.keys(xe).length&&(xe=void 0),Ce=Ne.handler.handle({url:Ee,event:_e,params:xe});break}}!Ce&&this.defaultHandler&&(Ce=this.defaultHandler.handle({url:Ee,event:_e})),Ce&&this.catchHandler&&(Ce=Ce.catch(Ne=>{return this.catchHandler.handle({url:Ee,event:_e,error:Ne})})),Ce&&_e.respondWith(Ce)}})}registerRoute({route:be}={}){q.isInstance({route:be},k),this.registerRoutes({routes:[be]})}}class M{constructor(){this._router=new A}registerRoute(be,_e){if('function'==typeof _e&&(_e={handle:_e}),'string'==typeof be){if(0===be.length)throw E.createError('empty-express-string');this._router.registerRoute({route:new S({path:be,handler:_e})})}else if(be instanceof RegExp)this._router.registerRoute({route:new W({regExp:be,handler:_e})});else if(be instanceof k)this._router.registerRoute({route:be});else throw E.createError('unsupported-route-type')}}const P={'not-in-sw':'sw-precaching must be loaded in your service worker file.','invalid-revisioned-entry':`File manifest entries must be either a `+`string with revision info in the url or an object with a 'url' and `+`'revision' parameters.`,'invalid-unrevisioned-entry':``,'bad-cache-bust':`The cache bust parameter must be a boolean.`,'duplicate-entry-diff-revisions':`An attempt was made to cache the same `+`url twice with each having different revisions. This is not supported.`,'request-not-cached':`A request failed the criteria to be cached. By `+`default, only responses with 'response.ok = true' are cached.`,'should-override':'Method should be overridden by the extending class.'};var O=new b(P);let R=`sw-runtime-caching`;self&&self.registration&&(R+=`-${self.registration.scope}`);const U=R,B=['cacheDidUpdate','cacheWillMatch','cacheWillUpdate','fetchDidFail','requestWillFetch'];var F=new b({'multiple-cache-will-update-behaviors':'You cannot register more than one behavior that implements cacheWillUpdate.','multiple-cache-will-match-behaviors':'You cannot register more than one behavior that implements cacheWillMatch.','invalid-reponse-for-caching':'The fetched response could not be cached due to an invalid response code, by default only 20X responses can be cached.'}),K=function(be){return function(){var _e=be.apply(this,arguments);return new Promise(function(Ee,Ce){function Ne(qe,xe){try{var ke=_e[qe](xe),Te=ke.value}catch(Ie){return void Ce(Ie)}return ke.done?void Ee(Te):Promise.resolve(Te).then(function(Ie){Ne('next',Ie)},function(Ie){Ne('throw',Ie)})}return Ne('next')})}};class L{constructor({cacheName:be,behaviors:_e,fetchOptions:Ee,matchOptions:Ce}={}){if(be?(q.isType({cacheName:be},'string'),this.cacheName=be):this.cacheName=U,Ee&&(q.isType({fetchOptions:Ee},'object'),this.fetchOptions=Ee),Ce&&(q.isType({matchOptions:Ce},'object'),this.matchOptions=Ce),this.behaviorCallbacks={},_e&&(q.isInstance({behaviors:_e},Array),_e.forEach(Ne=>{for(let qe of B)'function'==typeof Ne[qe]&&(this.behaviorCallbacks[qe]||(this.behaviorCallbacks[qe]=[]),this.behaviorCallbacks[qe].push(Ne[qe].bind(Ne)))})),this.behaviorCallbacks.cacheWillUpdate&&1!==this.behaviorCallbacks.cacheWillUpdate.length)throw F.createError('multiple-cache-will-update-behaviors');if(this.behaviorCallbacks.cacheWillMatch&&1!==this.behaviorCallbacks.cacheWillMatch.length)throw F.createError('multiple-cache-will-match-behaviors')}getCache(){var be=this;return K(function*(){return be._cache||(be._cache=yield caches.open(be.cacheName)),be._cache})()}match({request:be}){var _e=this;return K(function*(){q.atLeastOne({request:be});const Ee=yield _e.getCache();let Ce=yield Ee.match(be,_e.matchOptions);return _e.behaviorCallbacks.cacheWillMatch&&(Ce=_e.behaviorCallbacks.cacheWillMatch[0]({cachedResponse:Ce})),Ce})()}fetch({request:be}){var _e=this;return K(function*(){q.atLeastOne({request:be});try{if(_e.behaviorCallbacks.fetchDidFail)for(let Ee of _e.behaviorCallbacks.requestWillFetch)be=Ee({request:be});return yield fetch(be,_e.fetchOptions)}catch(Ee){if(_e.behaviorCallbacks.fetchDidFail)for(let Ce of _e.behaviorCallbacks.fetchDidFail)Ce({request:be});throw Ee}})()}fetchAndCache({request:be,waitOnCache:_e,cacheKey:Ee}){var Ce=this;return K(function*(){q.atLeastOne({request:be});let Ne;const qe=yield Ce.fetch({request:be});let xe=qe.ok;if(Ce.behaviorCallbacks.cacheWillUpdate&&(xe=Ce.behaviorCallbacks.cacheWillUpdate[0]({request:be,response:qe})),xe){const ke=qe.clone();Ne=Ce.getCache().then((()=>{var Te=K(function*(Ie){let we;'opaque'!==qe.type&&Ce.behaviorCallbacks.cacheDidUpdate&&(we=yield Ce.match({request:be})),yield Ie.put(Ee||be,ke);for(let De of Ce.behaviorCallbacks.cacheDidUpdate||[])De({cacheName:Ce.cacheName,oldResponse:we,newResponse:ke})});return function(Ie){return Te.apply(this,arguments)}})())}else if(!xe&&_e)throw F.createError('invalid-reponse-for-caching');return _e&&Ne&&(yield Ne),qe})()}}class H{constructor({requestWrapper:be}={}){this.requestWrapper=be?be:new L}handle({event:be,params:_e}={}){throw Error('This abstract method must be implemented in a subclass.')}}class $ extends H{handle({event:be}={}){var _e=this;return K(function*(){q.isInstance({event:be},FetchEvent);const Ee=yield _e.requestWrapper.match({request:be.request});return Ee||(yield _e.requestWrapper.fetchAndCache({request:be.request}))})()}}class G extends H{handle({event:be}={}){var _e=this;return K(function*(){return q.isInstance({event:be},FetchEvent),yield _e.requestWrapper.match({request:be.request})})()}}class V extends H{handle({event:be}={}){var _e=this;return K(function*(){q.isInstance({event:be},FetchEvent);let Ee;try{if(Ee=yield _e.requestWrapper.fetchAndCache({request:be.request}),Ee)return Ee}catch(Ce){}return yield _e.requestWrapper.match({request:be.request})})()}}class Y extends H{handle({event:be}={}){var _e=this;return K(function*(){return q.isInstance({event:be},FetchEvent),yield _e.requestWrapper.fetch({request:be.request})})()}}class z extends H{handle({event:be}={}){var _e=this;return K(function*(){q.isInstance({event:be},FetchEvent);const Ee=_e.requestWrapper.fetchAndCache({request:be.request}).catch(function(){return Response.error()}),Ce=yield _e.requestWrapper.match({request:be.request});return Ce||(yield Ee)})()}}class X{constructor(be){this._entriesToCache=new Map,this._requestWrapper=new L({cacheName:be,fetchOptions:{credentials:'same-origin'}}),this._cacheName=this._requestWrapper.cacheName}_addEntries(be){this._parsedCacheUrls=null,be.forEach(_e=>{this._addEntryToInstallList(this._parseEntry(_e))})}getCacheName(){return this._cacheName}getCachedUrls(){return this._parsedCacheUrls||(this._parsedCacheUrls=Array.from(this._entriesToCache.keys()).map(be=>new URL(be,location).href)),this._parsedCacheUrls}_addEntryToInstallList(be){const _e=be.entryID,Ee=this._entriesToCache.get(be.entryID);return Ee?void this._onDuplicateInstallEntryFound(be,Ee):void this._entriesToCache.set(_e,be)}install(){var be=this;return K(function*(){if(0!==be._entriesToCache.size){const _e=[];return be._entriesToCache.forEach(function(Ee){_e.push(be._cacheEntry(Ee))}),Promise.all(_e)}})()}_cacheEntry(be){var _e=this;return K(function*(){const Ee=yield _e._isAlreadyCached(be);if(!Ee)try{return yield _e._requestWrapper.fetchAndCache({request:be.getNetworkRequest(),waitOnCache:!0,cacheKey:be.request}),_e._onEntryCached(be)}catch(Ce){throw O.createError('request-not-cached',{message:`Failed to get a cacheable response for `+`'${be.request.url}': ${Ce.message}`})}})()}cleanup(){var be=this;return K(function*(){if(yield caches.has(be._cacheName)){const _e=[];be._entriesToCache.forEach(function(qe){_e.push(qe.request.url)});const Ee=yield be._getCache(),Ce=yield Ee.keys(),Ne=Ce.filter(function(qe){return!_e.includes(qe.url)});return Promise.all(Ne.map(function(qe){return Ee.delete(qe)}))}})()}_getCache(){var be=this;return K(function*(){return be._cache||(be._cache=yield caches.open(be._cacheName)),be._cache})()}_parseEntry(be){throw O.createError('should-override')}_onDuplicateEntryFound(be,_e){throw O.createError('should-override')}_isAlreadyCached(be){throw O.createError('should-override')}_onEntryCached(be){throw O.createError('should-override')}}var J=function(_e,Ee){return Ee={exports:{}},_e(Ee,Ee.exports),Ee.exports}(function(be){'use strict';(function(){function _e(Pe){return Array.prototype.slice.call(Pe)}function Ee(Pe){return new Promise(function(je,Oe){Pe.onsuccess=function(){je(Pe.result)},Pe.onerror=function(){Oe(Pe.error)}})}function Ce(Pe,je,Oe){var Re,Ue=new Promise(function(Be,Fe){Re=Pe[je].apply(Pe,Oe),Ee(Re).then(Be,Fe)});return Ue.request=Re,Ue}function Ne(Pe,je,Oe){var Re=Ce(Pe,je,Oe);return Re.then(function(Ue){if(Ue)return new we(Ue,Re.request)})}function qe(Pe,je,Oe){Oe.forEach(function(Re){Object.defineProperty(Pe.prototype,Re,{get:function(){return this[je][Re]},set:function(Ue){this[je][Re]=Ue}})})}function xe(Pe,je,Oe,Re){Re.forEach(function(Ue){Ue in Oe.prototype&&(Pe.prototype[Ue]=function(){return Ce(this[je],Ue,arguments)})})}function ke(Pe,je,Oe,Re){Re.forEach(function(Ue){Ue in Oe.prototype&&(Pe.prototype[Ue]=function(){return this[je][Ue].apply(this[je],arguments)})})}function Te(Pe,je,Oe,Re){Re.forEach(function(Ue){Ue in Oe.prototype&&(Pe.prototype[Ue]=function(){return Ne(this[je],Ue,arguments)})})}function Ie(Pe){this._index=Pe}function we(Pe,je){this._cursor=Pe,this._request=je}function De(Pe){this._store=Pe}function Se(Pe){this._tx=Pe,this.complete=new Promise(function(je,Oe){Pe.oncomplete=function(){je()},Pe.onerror=function(){Oe(Pe.error)},Pe.onabort=function(){Oe(Pe.error)}})}function We(Pe,je,Oe){this._db=Pe,this.oldVersion=je,this.transaction=new Se(Oe)}function Ae(Pe){this._db=Pe}qe(Ie,'_index',['name','keyPath','multiEntry','unique']),xe(Ie,'_index',IDBIndex,['get','getKey','getAll','getAllKeys','count']),Te(Ie,'_index',IDBIndex,['openCursor','openKeyCursor']),qe(we,'_cursor',['direction','key','primaryKey','value']),xe(we,'_cursor',IDBCursor,['update','delete']),['advance','continue','continuePrimaryKey'].forEach(function(Pe){Pe in IDBCursor.prototype&&(we.prototype[Pe]=function(){var je=this,Oe=arguments;return Promise.resolve().then(function(){return je._cursor[Pe].apply(je._cursor,Oe),Ee(je._request).then(function(Re){if(Re)return new we(Re,je._request)})})})}),De.prototype.createIndex=function(){return new Ie(this._store.createIndex.apply(this._store,arguments))},De.prototype.index=function(){return new Ie(this._store.index.apply(this._store,arguments))},qe(De,'_store',['name','keyPath','indexNames','autoIncrement']),xe(De,'_store',IDBObjectStore,['put','add','delete','clear','get','getAll','getKey','getAllKeys','count']),Te(De,'_store',IDBObjectStore,['openCursor','openKeyCursor']),ke(De,'_store',IDBObjectStore,['deleteIndex']),Se.prototype.objectStore=function(){return new De(this._tx.objectStore.apply(this._tx,arguments))},qe(Se,'_tx',['objectStoreNames','mode']),ke(Se,'_tx',IDBTransaction,['abort']),We.prototype.createObjectStore=function(){return new De(this._db.createObjectStore.apply(this._db,arguments))},qe(We,'_db',['name','version','objectStoreNames']),ke(We,'_db',IDBDatabase,['deleteObjectStore','close']),Ae.prototype.transaction=function(){return new Se(this._db.transaction.apply(this._db,arguments))},qe(Ae,'_db',['name','version','objectStoreNames']),ke(Ae,'_db',IDBDatabase,['close']),['openCursor','openKeyCursor'].forEach(function(Pe){[De,Ie].forEach(function(je){je.prototype[Pe.replace('open','iterate')]=function(){var Oe=_e(arguments),Re=Oe[Oe.length-1],Ue=this._store||this._index,Be=Ue[Pe].apply(Ue,Oe.slice(0,-1));Be.onsuccess=function(){Re(Be.result)}}})}),[Ie,De].forEach(function(Pe){Pe.prototype.getAll||(Pe.prototype.getAll=function(je,Oe){var Re=this,Ue=[];return new Promise(function(Be){Re.iterateCursor(je,function(Fe){return Fe?(Ue.push(Fe.value),void 0!==Oe&&Ue.length==Oe?void Be(Ue):void Fe.continue()):void Be(Ue)})})})});var Me={open:function(Pe,je,Oe){var Re=Ce(indexedDB,'open',[Pe,je]),Ue=Re.request;return Ue.onupgradeneeded=function(Be){Oe&&Oe(new We(Ue.result,Be.oldVersion,Ue.transaction))},Re.then(function(Be){return new Ae(Be)})},delete:function(Pe){return Ce(indexedDB,'deleteDatabase',[Pe])}};be.exports=Me})()});class Q{constructor(be,_e,Ee){if(be==void 0||_e==void 0||Ee==void 0)throw Error('name, version, storeName must be passed to the constructor.');this._name=be,this._version=_e,this._storeName=Ee}_getDb(){return this._dbPromise?this._dbPromise:(this._dbPromise=J.open(this._name,this._version,be=>{be.createObjectStore(this._storeName)}).then(be=>{return be}),this._dbPromise)}close(){return this._dbPromise?this._dbPromise.then(be=>{be.close(),this._dbPromise=null}):void 0}put(be,_e){return this._getDb().then(Ee=>{const Ce=Ee.transaction(this._storeName,'readwrite'),Ne=Ce.objectStore(this._storeName);return Ne.put(_e,be),Ce.complete})}delete(be){return this._getDb().then(_e=>{const Ee=_e.transaction(this._storeName,'readwrite'),Ce=Ee.objectStore(this._storeName);return Ce.delete(be),Ee.complete})}get(be){return this._getDb().then(_e=>{return _e.transaction(this._storeName).objectStore(this._storeName).get(be)})}getAllValues(){return this._getDb().then(be=>{return be.transaction(this._storeName).objectStore(this._storeName).getAll()})}getAllKeys(){return this._getDb().then(be=>{return be.transaction(this._storeName).objectStore(this._storeName).getAllKeys()})}}let Z=`sw-precaching-revisioned-${'v1'}`;self&&self.registration&&(Z+=`-${self.registration.scope}`);const ee=Z;class te{constructor(){this._idbHelper=new Q('sw-precaching','1','asset-revisions')}get(be){return this._idbHelper.get(be)}put(be,_e){return this._idbHelper.put(be,_e)}_close(){this._idbHelper.close()}}class ae{constructor({entryID:be,revision:_e,request:Ee,cacheBust:Ce}){this.entryID=be,this.revision=_e,this.request=Ee,this.cacheBust=Ce}getNetworkRequest(){if(!0!==this.cacheBust)return this.request;let be=this.request.url;const _e={};if(!0===this.cacheBust)if('cache'in Request.prototype)_e.cache='reload';else{const Ee=new URL(be,location);Ee.search+=(Ee.search?'&':'')+encodeURIComponent('_sw-precaching')+'='+encodeURIComponent(this.revision),be=Ee.toString()}return new Request(be,_e)}}class ne extends ae{constructor(be){if(q.isType({url:be},'string'),0===be.length)throw O.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(be)));super({entryID:be,revision:be,request:new Request(be),cacheBust:!1})}}class se extends ae{constructor({entryID:be,revision:_e,url:Ee,cacheBust:Ce}){if('undefined'==typeof Ce&&(Ce=!0),'undefined'==typeof be&&(be=new URL(Ee,location).toString()),q.isType({revision:_e},'string'),0===_e.length)throw O.createError('invalid-revisioned-entry',new Error('Bad revision Parameter. It should be a string with at least one character: '+JSON.stringify(_e)));if(q.isType({url:Ee},'string'),0===Ee.length)throw O.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(Ee)));if(q.isType({entryID:be},'string'),0===be.length)throw O.createError('invalid-revisioned-entry',new Error('Bad entryID Parameter. It should be a string with at least one character: '+JSON.stringify(be)));q.isType({cacheBust:Ce},'boolean'),super({entryID:be,revision:_e,request:new Request(Ee),cacheBust:Ce})}}class ie extends X{constructor({cacheName:be}={}){be=be||ee,super(be),this._revisionDetailsModel=new te}addToCacheList({revisionedFiles:be}={}){q.isInstance({revisionedFiles:be},Array),super._addEntries(be)}_parseEntry(be){if('undefined'==typeof be||null===be)throw O.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(be)));let _e;switch(typeof be){case'string':_e=new ne(be);break;case'object':_e=new se(be);break;default:throw O.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(_e)));}return _e}_onDuplicateInstallEntryFound(be,_e){if(_e.revision!==be.revision)throw O.createError('duplicate-entry-diff-revisions',new Error(`${JSON.stringify(_e)} <=> `+`${JSON.stringify(be)}`))}_isAlreadyCached(be){var _e=this;return K(function*(){const Ee=yield _e._revisionDetailsModel.get(be.entryID);if(Ee!==be.revision)return!1;const Ce=yield _e._getCache(),Ne=yield Ce.match(be.request);return!!Ne})()}_onEntryCached(be){var _e=this;return K(function*(){yield _e._revisionDetailsModel.put(be.entryID,be.revision)})()}_close(){this._revisionDetailsModel._close()}cleanup(){return super.cleanup().then(()=>{return this._close()})}}class oe extends ae{constructor(be){if(!(be instanceof Request))throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(be)));super({entryID:be.url,request:be,cacheBust:!1})}}class ce extends X{constructor({cacheName:be}={}){super(be)}addToCacheList({unrevisionedFiles:be}={}){q.isInstance({unrevisionedFiles:be},Array),super._addEntries(be)}_parseEntry(be){if('undefined'==typeof be||null===be)throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(be)));if('string'==typeof be)return new ne(be);if(be instanceof Request)return new oe(be);throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(be)))}_onDuplicateInstallEntryFound(be,_e){}_isAlreadyCached(be){return K(function*(){return!1})()}_onEntryCached(be){}}if(!q.isSWEnv())throw O.createError('not-in-sw');const de=`sw-cache-expiration-${self.registration.scope}`,he='url',le='timestamp';class pe{constructor({maxEntries:be,maxAgeSeconds:_e}={}){q.atLeastOne({maxEntries:be,maxAgeSeconds:_e}),be!==void 0&&q.isType({maxEntries:be},'number'),_e!==void 0&&q.isType({maxAgeSeconds:_e},'number'),this.maxEntries=be,this.maxAgeSeconds=_e,this._dbs=new Map,this._caches=new Map}getDB({cacheName:be}){var _e=this;return K(function*(){if(!_e._dbs.has(be)){const Ee=yield J.open(de,1,function(Ce){const Ne=Ce.createObjectStore(be,{keyPath:he});Ne.createIndex(le,le,{unique:!1})});_e._dbs.set(be,Ee)}return _e._dbs.get(be)})()}getCache({cacheName:be}){var _e=this;return K(function*(){if(!_e._caches.has(be)){const Ee=yield caches.open(be);_e._caches.set(be,Ee)}return _e._caches.get(be)})()}cacheWillMatch({cachedResponse:be}={}){return this.isResponseFresh({cachedResponse:be})?be:null}isResponseFresh({cachedResponse:be}={}){if(be&&this.maxAgeSeconds){q.isInstance({cachedResponse:be},Response);const _e=be.headers.get('date');if(_e){const Ee=Date.now(),Ce=new Date(_e);if(Ce.getTime()+1000*this.maxAgeSeconds<Ee)return!1}}return!0}cacheDidUpdate({cacheName:be,newResponse:_e}={}){q.isType({cacheName:be},'string'),q.isInstance({newResponse:_e},Response);const Ee=Date.now();this.updateTimestamp({cacheName:be,now:Ee,url:_e.url}).then(()=>{this.expireEntries({cacheName:be,now:Ee})})}updateTimestamp({cacheName:be,url:_e,now:Ee}){var Ce=this;return K(function*(){q.isType({url:_e},'string'),'undefined'==typeof Ee&&(Ee=Date.now());const Ne=yield Ce.getDB({cacheName:be}),qe=Ne.transaction(be,'readwrite');qe.objectStore(be).put({[le]:Ee,[he]:_e}),yield qe.complete})()}expireEntries({cacheName:be,now:_e}={}){var Ee=this;return K(function*(){'undefined'==typeof _e&&(_e=Date.now());const Ce=Ee.maxAgeSeconds?yield Ee.findOldEntries({cacheName:be,now:_e}):[],Ne=Ee.maxEntries?yield Ee.findExtraEntries({cacheName:be}):[],qe=[...new Set(Ce.concat(Ne))];return yield Ee.deleteFromCacheAndIDB({cacheName:be,urls:qe}),qe})()}findOldEntries({cacheName:be,now:_e}={}){var Ee=this;return K(function*(){q.isType({now:_e},'number');const Ce=_e-1000*Ee.maxAgeSeconds,Ne=[],qe=yield Ee.getDB({cacheName:be}),xe=qe.transaction(be,'readonly'),ke=xe.objectStore(be),Te=ke.index(le);return Te.iterateCursor(function(Ie){Ie&&(Ie.value[le]<Ce&&Ne.push(Ie.value[he]),Ie.continue())}),yield xe.complete,Ne})()}findExtraEntries({cacheName:be}){var _e=this;return K(function*(){const Ee=[],Ce=yield _e.getDB({cacheName:be}),Ne=Ce.transaction(be,'readonly'),qe=Ne.objectStore(be),xe=qe.index(le),ke=yield xe.count();return ke>_e.maxEntries&&xe.iterateCursor(function(Te){Te&&(Ee.push(Te.value[he]),ke-Ee.length>_e.maxEntries&&Te.continue())}),yield Ne.complete,Ee})()}deleteFromCacheAndIDB({cacheName:be,urls:_e}={}){var Ee=this;return K(function*(){if(q.isInstance({urls:_e},Array),0<_e.length){const Ce=yield Ee.getCache({cacheName:be}),Ne=yield Ee.getDB({cacheName:be});yield _e.forEach((()=>{var qe=K(function*(xe){yield Ce.delete(xe);const ke=Ne.transaction(be,'readwrite'),Te=ke.objectStore(be);yield Te.delete(xe),yield ke.complete});return function(xe){return qe.apply(this,arguments)}})())}})()}}const ue={'channel-name-required':`The channelName parameter is required when
    constructing a new Behavior`,'responses-are-same-parameters-required':`The first, second, and
    headersToCheck parameters must be valid when calling responsesAreSame()`};var me=new b(ue);const ge=['content-length','etag','last-modified'];class fe{constructor({channelName:be,headersToCheck:_e,source:Ee}={}){if('string'!=typeof be||0===be.length)throw me.createError('channel-name-required');this.channelName=be,this.headersToCheck=_e||ge,this.source=Ee||'sw-broadcast-cache-update'}get channel(){return this._channel||(this._channel=new BroadcastChannel(this.channelName)),this._channel}cacheDidUpdate({cacheName:be,oldResponse:_e,newResponse:Ee}){q.isType({cacheName:be},'string'),q.isInstance({newResponse:Ee},Response),_e&&this.notifyIfUpdated({cacheName:be,first:_e,second:Ee})}notifyIfUpdated({first:be,second:_e,cacheName:Ee}){q.isType({cacheName:Ee},'string'),v({first:be,second:_e,headersToCheck:this.headersToCheck})||y({cacheName:Ee,url:_e.url,channel:this.channel,source:this.source})}}class ye{constructor(){this._router=new M,this._revisionedCacheManager=new ie,this._unrevisionedCacheManager=new ce,this._registerInstallActivateEvents(),this._registerDefaultRoutes()}cacheRevisionedAssets(be){if(!Array.isArray(be))throw E.createError('bad-revisioned-cache-list');this._revisionedCacheManager.addToCacheList({revisionedFiles:be})}warmRuntimeCache(be){if(!Array.isArray(be))throw E.createError('bad-revisioned-cache-list');this._unrevisionedCacheManager.addToCacheList({unrevisionedFiles:be})}get router(){return this._router}get Route(){return k}cacheFirst(be){return this._getCachingMechanism($,be)}cacheOnly(be){return this._getCachingMechanism(G,be)}networkFirst(be){return this._getCachingMechanism(V,be)}networkOnly(be){return this._getCachingMechanism(Y,be)}staleWhileRevalidate(be){return this._getCachingMechanism(z,be)}_getCachingMechanism(be,_e={}){const Ee={cacheExpiration:pe,broadcastCacheUpdate:fe},Ce={behaviors:[]};_e.cacheName&&(Ce.cacheName=_e.cacheName);const Ne=Object.keys(Ee);return Ne.forEach(qe=>{if(_e[qe]){const xe=Ee[qe],ke=_e[qe];Ce.behaviors.push(new xe(ke))}}),_e.behaviors&&_e.behaviors.forEach(qe=>{Ce.behaviors.push(qe)}),new be({requestWrapper:new L(Ce)})}_registerInstallActivateEvents(){self.addEventListener('install',be=>{be.waitUntil(Promise.all([this._revisionedCacheManager.install(),this._unrevisionedCacheManager.install()]))}),self.addEventListener('activate',be=>{be.waitUntil(Promise.all([this._revisionedCacheManager.cleanup(),this._unrevisionedCacheManager.cleanup()]))})}_registerDefaultRoutes(){const be=this.cacheFirst({cacheName:this._revisionedCacheManager.getCacheName()}),_e=new this.Route({match:({url:Ee,event:Ce})=>{const Ne=this._revisionedCacheManager.getCachedUrls();return-1!==Ne.indexOf(Ee.href)},handler:be});this.router.registerRoute(_e)}}if(!q.isSWEnv())throw E.createError('not-in-sw');const ve=new ye;return ve});